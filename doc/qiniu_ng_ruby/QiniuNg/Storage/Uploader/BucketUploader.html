<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: QiniuNg::Storage::Uploader::BucketUploader
  
    &mdash; Documentation by YARD 0.9.24
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "QiniuNg::Storage::Uploader::BucketUploader";
  relpath = '../../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../../_index.html">Index (B)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../QiniuNg.html" title="QiniuNg (module)">QiniuNg</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Storage.html" title="QiniuNg::Storage (module)">Storage</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Uploader.html" title="QiniuNg::Storage::Uploader (class)">Uploader</a></span></span>
     &raquo; 
    <span class="title">BucketUploader</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: QiniuNg::Storage::Uploader::BucketUploader
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">QiniuNg::Storage::Uploader::BucketUploader</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/qiniu_ng/storage/uploader/bucket_uploader.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>存储空间上传器</p>

<p>为指定存储空间的上传准备初始化数据，可以反复使用以上传多个文件</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upload_file-instance_method" title="#upload_file (instance method)">#<strong>upload_file</strong>(file, upload_token:, key: nil, file_name: nil, mime: nil, vars: nil, metadata: nil, checksum_enabled: nil, resumable_policy: nil, on_uploading_progress: nil, upload_threshold: nil, thread_pool_size: nil, max_concurrency: nil)  &#x21d2; UploadResponse </a>
    

    
      (also: #upload_io)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>上传文件.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upload_file_path-instance_method" title="#upload_file_path (instance method)">#<strong>upload_file_path</strong>(file_path, upload_token:, key: nil, file_name: nil, mime: nil, vars: nil, metadata: nil, checksum_enabled: nil, resumable_policy: nil, on_uploading_progress: nil, upload_threshold: nil, thread_pool_size: nil, max_concurrency: nil)  &#x21d2; UploadResponse </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>根据文件路径上传文件.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="upload_file-instance_method">
  
    #<strong>upload_file</strong>(file, upload_token:, key: nil, file_name: nil, mime: nil, vars: nil, metadata: nil, checksum_enabled: nil, resumable_policy: nil, on_uploading_progress: nil, upload_threshold: nil, thread_pool_size: nil, max_concurrency: nil)  &#x21d2; <tt><span class='object_link'><a href="UploadResponse.html" title="QiniuNg::Storage::Uploader::UploadResponse (class)">UploadResponse</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='upload_io-instance_method'>upload_io</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>上传文件</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file</span>
      
      
        <span class='type'>(<tt>IO</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>要上传的文件</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>upload_token</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="UploadToken.html" title="QiniuNg::Storage::Uploader::UploadToken (class)">UploadToken</a></span></tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>上传凭证</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>对象名称</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>file_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>原始文件名称</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>vars</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p><a href="https://developer.qiniu.com/kodo/manual/1235/vars#xvar">自定义变量</a></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>metadata</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>元数据</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>checksum_enabled</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>是否启用文件校验，默认总是启用，且不推荐禁用</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>resumable_policy</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>分片上传策略，可以接受 <code>:default</code>, <code>:threshold</code>,
<code>:always_be_resumeable</code>, <code>:never_be_resumeable</code> 四种取值
默认且推荐使用 default 策略</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>on_uploading_progress</span>
      
      
        <span class='type'>(<tt>Lambda</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>上传进度回调，需要提供一个带有两个参数的闭包函数，第一个参数为已经上传的数据量，第二个参数为总数据量（如果总数据量未知，将返回 0），没有返回值</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>upload_threshold</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>分片上传策略阙值，仅当 resumable_policy 为 <code>:threshold</code> 时起效，为其设置分片上传的阙值</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>thread_pool_size</span>
      
      
        <span class='type'>(<tt>Ingeger</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>上传线程池尺寸，默认使用默认的线程池策略</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_concurrency</span>
      
      
        <span class='type'>(<tt>Ingeger</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>最大并发度，默认与线程池大小相同</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="UploadResponse.html" title="QiniuNg::Storage::Uploader::UploadResponse (class)">UploadResponse</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>上传响应</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>参数错误</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/storage/uploader/bucket_uploader.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upload_file'>upload_file</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='label'>upload_token:</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>file_name:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>mime:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>vars:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>metadata:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>checksum_enabled:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>resumable_policy:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>on_uploading_progress:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>upload_threshold:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>thread_pool_size:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                     <span class='label'>max_concurrency:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_upload_token'>upload_token</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_upload_token'>normalize_upload_token</span><span class='lparen'>(</span><span class='id identifier rubyid_upload_token'>upload_token</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_create_upload_params'>create_upload_params</span><span class='lparen'>(</span><span class='label'>key:</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
                                <span class='label'>file_name:</span> <span class='id identifier rubyid_file_name'>file_name</span><span class='comma'>,</span>
                                <span class='label'>mime:</span> <span class='id identifier rubyid_mime'>mime</span><span class='comma'>,</span>
                                <span class='label'>vars:</span> <span class='id identifier rubyid_vars'>vars</span><span class='comma'>,</span>
                                <span class='label'>metadata:</span> <span class='id identifier rubyid_metadata'>metadata</span><span class='comma'>,</span>
                                <span class='label'>checksum_enabled:</span> <span class='id identifier rubyid_checksum_enabled'>checksum_enabled</span><span class='comma'>,</span>
                                <span class='label'>resumable_policy:</span> <span class='id identifier rubyid_resumable_policy'>resumable_policy</span><span class='comma'>,</span>
                                <span class='label'>on_uploading_progress:</span> <span class='id identifier rubyid_on_uploading_progress'>on_uploading_progress</span><span class='comma'>,</span>
                                <span class='label'>upload_threshold:</span> <span class='id identifier rubyid_upload_threshold'>upload_threshold</span><span class='comma'>,</span>
                                <span class='label'>thread_pool_size:</span> <span class='id identifier rubyid_thread_pool_size'>thread_pool_size</span><span class='comma'>,</span>
                                <span class='label'>max_concurrency:</span> <span class='id identifier rubyid_max_concurrency'>max_concurrency</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reader'>reader</span> <span class='op'>=</span> <span class='const'>Bindings</span><span class='op'>::</span><span class='const'>CoreFFI</span><span class='op'>::</span><span class='const'>QiniuNgReadableT</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_reader'>reader</span><span class='lbracket'>[</span><span class='symbol'>:context</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_reader'>reader</span><span class='lbracket'>[</span><span class='symbol'>:read_func</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_proc'>proc</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__'>_</span><span class='comma'>,</span> <span class='id identifier rubyid_data'>data</span><span class='comma'>,</span> <span class='id identifier rubyid_size'>size</span><span class='comma'>,</span> <span class='id identifier rubyid_have_read'>have_read</span><span class='op'>|</span>
                         <span class='id identifier rubyid_content'>content</span> <span class='op'>=</span> <span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
                         <span class='kw'>if</span> <span class='id identifier rubyid_content'>content</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
                           <span class='id identifier rubyid_have_read'>have_read</span><span class='period'>.</span><span class='id identifier rubyid_write_ulong'>write_ulong</span><span class='lparen'>(</span><span class='int'>0</span><span class='rparen'>)</span>
                         <span class='kw'>else</span>
                           <span class='id identifier rubyid_data'>data</span><span class='period'>.</span><span class='id identifier rubyid_write_string'>write_string</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='rparen'>)</span>
                           <span class='id identifier rubyid_have_read'>have_read</span><span class='period'>.</span><span class='id identifier rubyid_write_ulong'>write_ulong</span><span class='lparen'>(</span><span class='id identifier rubyid_content'>content</span><span class='period'>.</span><span class='id identifier rubyid_bytesize'>bytesize</span><span class='rparen'>)</span>
                         <span class='kw'>end</span>
                         <span class='int'>0</span>
                       <span class='kw'>end</span>
  <span class='id identifier rubyid_upload_response'>upload_response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../QiniuNg.html" title="QiniuNg (module)">QiniuNg</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Error.html" title="QiniuNg::Error (class)">Error</a></span></span><span class='period'>.</span><span class='id identifier rubyid_wrap_ffi_function'>wrap_ffi_function</span> <span class='kw'>do</span>
                      <span class='ivar'>@bucket_uploader</span><span class='period'>.</span><span class='id identifier rubyid_upload_reader'>upload_reader</span><span class='lparen'>(</span>
                        <span class='id identifier rubyid_upload_token'>upload_token</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='symbol'>:@upload_token</span><span class='rparen'>)</span><span class='comma'>,</span>
                        <span class='id identifier rubyid_reader'>reader</span><span class='comma'>,</span>
                        <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
                    <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="UploadResponse.html" title="QiniuNg::Storage::Uploader::UploadResponse (class)">UploadResponse</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:new</span><span class='comma'>,</span> <span class='id identifier rubyid_upload_response'>upload_response</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="upload_file_path-instance_method">
  
    #<strong>upload_file_path</strong>(file_path, upload_token:, key: nil, file_name: nil, mime: nil, vars: nil, metadata: nil, checksum_enabled: nil, resumable_policy: nil, on_uploading_progress: nil, upload_threshold: nil, thread_pool_size: nil, max_concurrency: nil)  &#x21d2; <tt><span class='object_link'><a href="UploadResponse.html" title="QiniuNg::Storage::Uploader::UploadResponse (class)">UploadResponse</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>根据文件路径上传文件</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>file_path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>要上传的文件路径</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>upload_token</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="UploadToken.html" title="QiniuNg::Storage::Uploader::UploadToken (class)">UploadToken</a></span></tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>上传凭证</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>对象名称</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>file_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>原始文件名称</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>vars</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p><a href="https://developer.qiniu.com/kodo/manual/1235/vars#xvar">自定义变量</a></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>metadata</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>元数据</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>checksum_enabled</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>是否启用文件校验，默认总是启用，且不推荐禁用</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>resumable_policy</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>分片上传策略，可以接受 <code>:default</code>, <code>:threshold</code>,
<code>:always_be_resumeable</code>, <code>:never_be_resumeable</code> 四种取值
默认且推荐使用 default 策略</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>on_uploading_progress</span>
      
      
        <span class='type'>(<tt>Lambda</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>上传进度回调，需要提供一个带有两个参数的闭包函数，第一个参数为已经上传的数据量，第二个参数为总数据量（如果总数据量未知，将返回 0），没有返回值</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>upload_threshold</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>分片上传策略阙值，仅当 resumable_policy 为 <code>:threshold</code> 时起效，为其设置分片上传的阙值</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>thread_pool_size</span>
      
      
        <span class='type'>(<tt>Ingeger</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>上传线程池尺寸，默认使用默认的线程池策略</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_concurrency</span>
      
      
        <span class='type'>(<tt>Ingeger</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>最大并发度，默认与线程池大小相同</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="UploadResponse.html" title="QiniuNg::Storage::Uploader::UploadResponse (class)">UploadResponse</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>上传响应</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>参数错误</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/qiniu_ng/storage/uploader/bucket_uploader.rb', line 115</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upload_file_path'>upload_file_path</span><span class='lparen'>(</span><span class='id identifier rubyid_file_path'>file_path</span><span class='comma'>,</span> <span class='label'>upload_token:</span><span class='comma'>,</span> <span class='label'>key:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>file_name:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>mime:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>vars:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>metadata:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>checksum_enabled:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>resumable_policy:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>on_uploading_progress:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>upload_threshold:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>thread_pool_size:</span> <span class='kw'>nil</span><span class='comma'>,</span>
                                               <span class='label'>max_concurrency:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_upload_token'>upload_token</span> <span class='op'>=</span> <span class='id identifier rubyid_normalize_upload_token'>normalize_upload_token</span><span class='lparen'>(</span><span class='id identifier rubyid_upload_token'>upload_token</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='id identifier rubyid_create_upload_params'>create_upload_params</span><span class='lparen'>(</span><span class='label'>key:</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
                                <span class='label'>file_name:</span> <span class='id identifier rubyid_file_name'>file_name</span><span class='comma'>,</span>
                                <span class='label'>mime:</span> <span class='id identifier rubyid_mime'>mime</span><span class='comma'>,</span>
                                <span class='label'>vars:</span> <span class='id identifier rubyid_vars'>vars</span><span class='comma'>,</span>
                                <span class='label'>metadata:</span> <span class='id identifier rubyid_metadata'>metadata</span><span class='comma'>,</span>
                                <span class='label'>checksum_enabled:</span> <span class='id identifier rubyid_checksum_enabled'>checksum_enabled</span><span class='comma'>,</span>
                                <span class='label'>resumable_policy:</span> <span class='id identifier rubyid_resumable_policy'>resumable_policy</span><span class='comma'>,</span>
                                <span class='label'>on_uploading_progress:</span> <span class='id identifier rubyid_on_uploading_progress'>on_uploading_progress</span><span class='comma'>,</span>
                                <span class='label'>upload_threshold:</span> <span class='id identifier rubyid_upload_threshold'>upload_threshold</span><span class='comma'>,</span>
                                <span class='label'>thread_pool_size:</span> <span class='id identifier rubyid_thread_pool_size'>thread_pool_size</span><span class='comma'>,</span>
                                <span class='label'>max_concurrency:</span> <span class='id identifier rubyid_max_concurrency'>max_concurrency</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_upload_response'>upload_response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../QiniuNg.html" title="QiniuNg (module)">QiniuNg</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Error.html" title="QiniuNg::Error (class)">Error</a></span></span><span class='period'>.</span><span class='id identifier rubyid_wrap_ffi_function'>wrap_ffi_function</span> <span class='kw'>do</span>
                      <span class='ivar'>@bucket_uploader</span><span class='period'>.</span><span class='id identifier rubyid_upload_file_path'>upload_file_path</span><span class='lparen'>(</span>
                        <span class='id identifier rubyid_upload_token'>upload_token</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span><span class='symbol'>:@upload_token</span><span class='rparen'>)</span><span class='comma'>,</span>
                        <span class='id identifier rubyid_file_path'>file_path</span><span class='comma'>,</span>
                        <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
                    <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="UploadResponse.html" title="QiniuNg::Storage::Uploader::UploadResponse (class)">UploadResponse</a></span></span><span class='period'>.</span><span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='symbol'>:new</span><span class='comma'>,</span> <span class='id identifier rubyid_upload_response'>upload_response</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Fri Feb 28 09:13:02 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.24 (ruby-2.5.1).
</div>

    </div>
  </body>
</html>